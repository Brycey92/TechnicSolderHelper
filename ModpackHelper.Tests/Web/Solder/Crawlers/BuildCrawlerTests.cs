using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using NUnit.Framework;
using ModpackHelper.Shared.Web.Solder.Crawlers;

namespace ModpackHelper.Tests.Web.Solder.Crawlers
{
    [TestFixture]
    class BuildCrawlerTests
    {
        [Test]
        public void CanCrawl()
        {
            var crawler = new BuildCrawler();
            crawler.HTML = html;
            var build = crawler.Crawl();
            Assert.NotNull(build);
        }


        private const string html =
            "<!DOCTYPE html><html lang=\"en\"> <head> <meta charset=\"utf-8\"> <title>dc504f07-9d2a-4a53-9de8-500084c7204f - TEst apck - TechnicSolder</title> <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"> <link rel=\"shortcut icon\" href=\"http://solder.zlepper.dk/favicon.ico\"> <script src=\"http://solder.zlepper.dk/js/jquery-1.11.1.min.js\"></script> <script src=\"http://solder.zlepper.dk/js/bootstrap.min.js\"></script> <script src=\"http://solder.zlepper.dk/js/jquery.jgrowl.min.js\"></script> <link href=\"http://solder.zlepper.dk/css/bootstrap.min.css\" rel=\"stylesheet\"> <link href=\"http://solder.zlepper.dk/font-awesome/css/font-awesome.css\" rel=\"stylesheet\"> <link href=\"http://solder.zlepper.dk/css/sb-admin.css\" rel=\"stylesheet\"> <link href=\"http://solder.zlepper.dk/css/solder.css\" rel=\"stylesheet\"> <script src=\"http://solder.zlepper.dk/js/plugins/metisMenu/jquery.metisMenu.js\"></script> <script src=\"http://solder.zlepper.dk/js/sb-admin.js\"></script> <script src=\"http://solder.zlepper.dk/js/plugins/dataTables/jquery.dataTables.js\"></script> <script src=\"http://solder.zlepper.dk/js/plugins/dataTables/dataTables.bootstrap.js\"></script> <link href=\"http://solder.zlepper.dk/css/dataTables.bootstrap.css\" rel=\"stylesheet\"> <script src=\"http://solder.zlepper.dk/js/jquery.slugify.js\"></script> <script src=\"http://solder.zlepper.dk/js/nav-float.js\"></script> <link href=\"http://solder.zlepper.dk/css/OpenSansfont.css\" rel=\"stylesheet\"> <script src=\"http://solder.zlepper.dk/js/selectize.min.js\"></script> <link href=\"http://solder.zlepper.dk/css/selectize.css\" rel=\"stylesheet\"> </head> <body> <nav class=\"navbar navbar-default navbar-static-top\" role=\"navigation\" style=\"margin-bottom: 0\"> <div class=\"navbar-header\"> <button type=\"button\" class=\"navbar-toggle\" data-toggle=\"collapse\" data-target=\".sidebar-collapse\"> <span class=\"sr-only\">Toggle navigation</span> <span class=\"icon-bar\"></span> <span class=\"icon-bar\"></span> <span class=\"icon-bar\"></span> </button> <a class=\"navbar-brand\" href=\"http://solder.zlepper.dk/dashboard\"><img src=\"http://solder.zlepper.dk/img/title.png\"> v0.7.3.1</a> </div><ul class=\"nav navbar-top-links navbar-left\"> </ul> <ul class=\"nav navbar-top-links navbar-right\"> <li><a href=\"http://docs.solder.io/\" target=\"blank_\">Help <i class=\"fa fa-question\"></i></a></li><li class=\"dropdown\"> <a class=\"dropdown-toggle\" data-toggle=\"dropdown\" href=\"#\"> tester <i class=\"fa fa-user fa-fw\"></i> <i class=\"fa fa-caret-down\"></i> </a> <ul class=\"dropdown-menu dropdown-user\"> <li><a href=\"http://solder.zlepper.dk/user/edit/4\"><i class=\"fa fa-user fa-fw\"></i> User Profile</a> </li><li><a href=\"http://solder.zlepper.dk/logout\"><i class=\"fa fa-sign-out fa-fw\"></i> Logout</a> </li></ul> </li></ul> </nav> <nav class=\"navbar-default navbar-static-side\" role=\"navigation\"> <div class=\"sidebar-collapse\"> <ul class=\"nav side-menu\" id=\"side-menu\"> <li> <a href=\"http://solder.zlepper.dk/dashboard\" ><i class=\"fa fa-dashboard fa-fw\"></i> Dashboard</a> </li><li> <a href=\"#\"><i class=\"fa fa-folder fa-fw\"></i> Modpacks<span class=\"fa arrow\"></span></a> <ul class=\"nav nav-second-level\"> <li><a href=\"http://solder.zlepper.dk/modpack/view/28\"><img src=\"http://solder.zlepper.dk/resources/default/icon.png\" style=\"width: 16px; height: 16px;\"> TEst apck (Hidden)</a></li><li><a href=\"http://solder.zlepper.dk/modpack/list\">Modpack List</a></li><li><a href=\"http://solder.zlepper.dk/modpack/create\">Add Modpack</a></li></ul> </li><li> <a href=\"#\"><i class=\"fa fa-book fa-fw\"></i> Mod Library<span class=\"fa arrow\"></span></a></a> <ul class=\"nav nav-second-level\"> <li><a href=\"http://solder.zlepper.dk/mod/list\">Mod List</a></li><li><a href=\"http://solder.zlepper.dk/mod/create\">Add a Mod</a></li></ul> </li><li> <a href=\"#\"><i class=\"fa fa-wrench fa-fw\"></i> Configure Solder<span class=\"fa arrow\"></span></a> <ul class=\"nav nav-second-level\"> <li> <a href=\"http://solder.zlepper.dk/solder/configure\">Main Settings</a> </li><li> <a href=\"http://solder.zlepper.dk/solder/update\">Update Checker</a> </li><li> <a href=\"http://solder.zlepper.dk/user/list\">User Management</a> </li><li> <a href=\"http://solder.zlepper.dk/client/list\">Client Management</a> </li><li><a href=\"http://solder.zlepper.dk/key/list\">API Key Management</a></li></ul> </li></ul> </div></nav> <div id=\"page-wrapper\"> <div class=\"row\"> <div class=\"col-lg-12\"><div class=\"page-header\"><h1>Build Management</h1></div><div class=\"panel panel-default\"><div class=\"panel-heading\"><div class=\"pull-right\"><a href=\"http://solder.zlepper.dk/modpack/build/38\" class=\"btn btn-xs btn-warning\">Refresh</a><a href=\"http://solder.zlepper.dk/modpack/build/38?action=edit\" class=\"btn btn-xs btn-danger\">Edit</a><a href=\"http://solder.zlepper.dk/modpack/view/28\" class=\"btn btn-xs btn-info\">Back to Modpack</a></div>Build Info: TEst apck - Build dc504f07-9d2a-4a53-9de8-500084c7204f</div><div class=\"panel-body\"><div class=\"col-md-6\"><label>Build Version: <span class=\"label label-default\">dc504f07-9d2a-4a53-9de8-500084c7204f</span></label><br><label>Minecraft Version: <span class=\"label label-default\">1.7.10</span></label><br></div><div class=\"col-md-6\"><label>Java Version: <span class=\"label label-default\">1.7</span></label><br><label>Memory (<i>in MB</i>): <span class=\"label label-default\">1024</span></label></div></div></div><div class=\"panel panel-default\"><div class=\"panel-heading\">Build Management: TEst apck - Build dc504f07-9d2a-4a53-9de8-500084c7204f</div><div class=\"panel-body\"><div class=\"table-responsive\"><table class=\"table\"><thead><th style=\"width: 60%\">Add a Mod</th><th></th><th></th></thead><tbody><form method=\"post\" action=\"http://solder.zlepper.dk/modpack/build/modify\" class=\"mod-add\"><input type=\"hidden\" name=\"build\" value=\"38\"><input type=\"hidden\" name=\"action\" value=\"add\"><tr id=\"mod-list-add\"><td><i class=\"icon-plus\"></i><select class=\"form-control\" name=\"mod-name\" id=\"mod\" placeholder=\"Select a Mod...\"><option value=\"mod-3\">Mod-3</option><option value=\"mod-9\">Mod-9</option><option value=\"mod-5\">Mod-5</option><option value=\"mod-1\">Mod-1</option><option value=\"mod-4\">Mod-4</option><option value=\"mod-8\">Mod-8</option><option value=\"mod-6\">Mod-6</option><option value=\"mod-7\">Mod-7</option><option value=\"mod-0\">Mod-0</option><option value=\"mod-2\">Mod-2</option></select></td><td><select class=\"form-control\" name=\"mod-version\" id=\"mod-version\" placeholder=\"Select a Modversion...\"></select></td><td><button type=\"submit\" class=\"btn btn-success btn-small\">Add Mod</button></td></tr></form></tbody></table></div></div></div><div class=\"panel panel-default\"><div class=\"panel-heading\">Build Management: TEst apck - Build dc504f07-9d2a-4a53-9de8-500084c7204f</div><div class=\"panel-body\"><div class=\"table-responsive\"><table class=\"table\" id=\"mod-list\"><thead><th id=\"mod-header\" style=\"width: 60%\">Mod Name</th><th>Version</th><th></th></thead><tbody></tbody></table></div></div></div></div></div></div><script type=\"text/javascript\">(function($){$(function(){$.jGrowl.defaults.closerTemplate='<div class=\"alert alert-info\">Close All</div>';});})(jQuery); </script><script type=\"text/javascript\">var $select=$(\"#mod\").selectize({dropdownParent: \"body\",persist: false,maxItems: 1,sortField:{field: 'text',direction: 'asc'},});var mod=$select[0].selectize;var $select=$(\"#mod-version\").selectize({dropdownParent: \"body\",persist: false,maxItems: 1,sortField:{field: 'text',direction: 'asc'},});var modversion=$select[0].selectize;$(\".mod-version\").submit(function(e){e.preventDefault();$.ajax({type: \"POST\",url: \"http://solder.zlepper.dk/modpack/modify/version\",data: $(this).serialize(),success: function (data){console.log(data.reason);if(data.status=='success'){$.jGrowl(\"Modversion Updated\",{group: 'alert-success'});}else if(data.status=='failed'){$.jGrowl(\"Unable to update modversion\",{group: 'alert-warning'});}else if(data.status=='aborted'){$.jGrowl(\"Mod was already set to that version\",{group: 'alert-success'});}},error: function (xhr, textStatus, errorThrown){$.jGrowl(textStatus + ': ' + errorThrown,{group: 'alert-danger'});}});});$(\".mod-delete\").submit(function(e){e.preventDefault();$.ajax({type: \"POST\",url: \"http://solder.zlepper.dk/modpack/modify/delete\",data: $(this).serialize(),success: function (data){console.log(data.reason);if(data.status=='success'){$.jGrowl(\"Modversion Deleted\",{group: 'alert-success'});}else{$.jGrowl(\"Unable to delete modversion\",{group: 'alert-warning'});}},error: function (xhr, textStatus, errorThrown){$.jGrowl(textStatus + ': ' + errorThrown,{group: 'alert-danger'});}});$(this).parent().parent().fadeOut();});$(\".mod-add\").submit(function(e){e.preventDefault();if($(\"#mod-version\").val()){$.ajax({type: \"POST\",url: \"http://solder.zlepper.dk/modpack/modify/add\",data: $(this).serialize(),success: function (data){if(data.status=='success'){$(\"#mod-list-add\").after('<tr><td>' + data.pretty_name + '</td><td>' + data.version + '</td><td></td></tr>');$.jGrowl(\"Mod \" + data.pretty_name + \" added at \" + data.version,{group: 'alert-success'});}else{$.jGrowl(\"Unable to add mod. Reason: \" + data.reason,{group: 'alert-warning'});}},error: function (xhr, textStatus, errorThrown){$.jGrowl(textStatus + ': ' + errorThrown,{group: 'alert-danger'});}});}else{$.jGrowl(\"Please select a Modversion\",{group: 'alert-warning'});}});function refreshModVersions(){modversion.disable();modversion.clearOptions();$.ajax({type: \"GET\",url: \"http://solder.zlepper.dk/api/mod/\" + mod.getValue(),success: function (data){if (data.versions.length===0){$.jGrowl(\"No Modversions found for \" + data.pretty_name,{group: 'alert-warning'});$(\"#mod-version\").attr(\"placeholder\", \"No Modversions found...\");}else{$(data.versions).each(function(e, m){modversion.addOption({value: m, text: m});modversion.refreshOptions(false);$(\"#mod-version\").attr(\"placeholder\", \"Select a Modversion...\");});}},error: function (xhr, textStatus, errorThrown){$.jGrowl(textStatus + ': ' + errorThrown,{group: 'alert-danger'});}});modversion.enable();}mod.on('change', refreshModVersions);$( document ).ready(function(){$(\"#mod-list\").dataTable({\"order\": [[ 0, \"asc\"]], \"autoWidth\": false, \"columnDefs\": [{\"width\": \"60%\", \"targets\": 0},{\"width\": \"30%\", \"targets\": 1}]}); refreshModVersions();});</script> </body></html>";
    }
}
